#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <string.h>
#define len (12+1)

long int_pow(int base, int exp)
{
    long result = 1;
    while (exp)
    {
        if (exp % 2)
           result *= base;
        exp /= 2;
        base *= base;
    }
    return result;
}

long diag_report[] = {
1011111101011,
1101001110000,
1010010001011,
1011111100101,
1111110100011,
1100000010101,
1001110110111,
1101101111100,
1001101110111,
1010101000101,
1010001001110,
1000010001111,
1011111001000,
1011011111011,
1001101110100,
1011101111010,
1000101000000,
1011010101111,
1010001010010,
1110010101001,
1100000011111,
1001100001011,
1011100001000,
1100101100111,
1111011101101,
1011001010100,
1011110010100,
1010001110001,
1111001101110,
1011001110011,
1101110111100,
1101101010110,
1111111100101,
1001011100100,
1101000111101,
1001101100000,
1101011011110,
1111110000111,
1101101010010,
1001110100100,
1110010010101,
1110000011000,
1000000000100,
1100101011110,
1010101110001,
1110111100111,
1110110100101,
1100110000001,
1001111000011,
1000100101000,
1001100111011,
1001011010011,
1000110111010,
1001110011100,
1100010001100,
1011010000001,
1011100001111,
1110111111101,
1011100110101,
1110111010010,
1010111001110,
1110100110101,
1010010011011,
1100111010000,
1011100000111,
1011100011100,
1100111000011,
1111111110001,
1111011001000,
1001111111011,
1011001000100,
1100110010010,
1000000100111,
1101011001010,
1111111101001,
1011100101011,
1101110001101,
1111111010100,
1100100000010,
1111100001011,
1110000011101,
1110111100110,
1011100010101,
1100111001101,
1101101100001,
1000101101101,
1001001001110,
1101001100000,
1101010110001,
1100001010101,
1100100001001,
1111101100001,
1100000010010,
1000001101010,
1000110100011,
1110011111100,
1111010101110,
1011110111000,
1101011110001,
1100100100001,
1000000011011,
1000100000010,
1101011010110,
1011001111111,
1101111010000,
1100001101011,
1110111000110,
1111000110001,
1100000000101,
1100010111011,
1010100011111,
1100000011101,
1110011000010,
1010111111001,
1011011101111,
1110011111110,
1111011010011,
1000011010100,
1111010100000,
1010100101010,
1101000000011,
1000101100000,
1111101100100,
1111101101101,
1010000111111,
1100001000001,
1000011010110,
1110001101001,
1110100011110,
1000100001000,
1110010100011,
1010000010001,
1000010000100,
1100001000000,
1111110100101,
1001100001111,
1001001010001,
1101011110000,
1101101001111,
1110001011110,
1100011011101,
1100000110100,
1110011000100,
1110101001000,
1100010010001,
1001011011010,
1111000101000,
1111000100100,
1001001100010,
1100100011111,
1011101101100,
1001011111001,
1111000001100,
1100001101010,
1101001111011,
1010101100111,
1010111100101,
1010000110110,
1010011001001,
1011000110110,
1000000101111,
1101110111000,
1100010100010,
1001101011100,
1010010001000,
1011011110010,
1001001100000,
1001110010010,
1011011100001,
1100101001110,
1000100001111,
1100100110001,
1100100111010,
1110000010110,
1110010011110,
1110100110000,
1111011011111,
1000100111001,
1010111110000,
1111001100001,
1001010011100,
1010000000110,
1110010010010,
1101000001001,
1100111000100,
1001001111011,
1111000111000,
1000110100010,
1100001101001,
1000100111101,
1111111110111,
1100001000010,
1000111000100,
1110101001111,
1111101011011,
1100101111110,
1010110111101,
1100010101111,
1111010111011,
1110000100101,
1100111011001,
1110110100111,
1010011000011,
1000011010010,
1100011011110,
1001000100101,
1001001111010,
1110011001111,
1101010100111,
1011111010000,
1110001011101,
1010010101110,
1110011111011,
1011011101011,
1111110001011,
1011001000001,
1101111000110,
1111100101110,
1011011001110,
1010011010001,
1000101011001,
1111100101010,
1010000100001,
1101010100100,
1110110011110,
1111000111110,
1100111001100,
1001000100001,
1110110110011,
1111110101111,
1011110111110,
1000101101110,
1000011111111,
1010101111000,
1010000001100,
1010111100001,
1111010110100,
1001110000001,
1101100101111,
1010110100001,
1011100000110,
1110001001000,
1100110101001,
1001000111010,
1101100000101,
1100110011101,
1011110101101,
1011100010100,
1000011100000,
1000011101111,
1100100000001,
1010001100100,
1001111000110,
1101001010110,
1000011101101,
1111110001100,
1101011101110,
1100001010110,
1111110110010,
1000101111111,
1000111101111,
1011000011001,
1101101000101,
1110110111001,
1111010011000,
1000100100110,
1001110011010,
1001001011000,
1101001011001,
1110111000001,
1000101110101,
1100001110101,
1110010100010,
1001000010011,
1000011000100,
1111100000000,
1011000100001,
1000111000110,
1010101011011,
1001110011011,
1110011101001,
1001111101001,
1010100100101,
1011111000100,
1010000011101,
1010101001100,
1001011010010,
1010001011100,
1011011010011,
1001000111101,
1011011101010,
1001010010001,
1010101011000,
1011110100000,
1010010001100,
1000010001011,
1000000001101,
1001111000001,
1100111001011,
1010000001111,
1010111111111,
1110000100100,
1110111001001,
1111010011101,
1001000000010,
1011110010000,
1111111111110,
1011011111111,
1110010110011,
1001100101111,
1101011101010,
1111111000011,
1101011000100,
1011001011000,
1111001000100,
1001011001100,
1011010001101,
1100100011100,
1111000101111,
1111010001001,
1100110000010,
1100011000110,
1001101011011,
1110000011011,
1010101010000,
1010100001000,
1000011010000,
1110110001110,
1111001001010,
1010011111111,
1010011110111,
1111100010100,
1110101101010,
1100100011001,
1111101011000,
1011000001011,
1101011100100,
1111011101100,
1011010011110,
1000100010111,
1010101100011,
1000001000000,
1001000110110,
1100000110110,
1000100101010,
1010111001111,
1100100010110,
1111000011100,
1111100010000,
1001100010100,
1010001011011,
1111101110110,
1100011111101,
1100001010010,
1011111101100,
1010110011110,
1111100011001,
1110110010110,
1110011011011,
1000100100010,
1111110110110,
1010110010110,
1000000111110,
1110010101000,
1011100100100,
1110011100000,
1001011100110,
1001000110111,
1010011001010,
1001011001110,
1100010010010,
1100011000100,
1110010111000,
1100010111000,
1111010000000,
1010101001110,
1110100010100,
1010011010110,
1111111000110,
1000110111001,
1001011000101,
1110111011001,
1101001101001,
1111001111111,
1111100000100,
1100100110100,
1110100000010,
1000100011011,
1100101000000,
1000000000111,
1101010100001,
1010011101000,
1101101101010,
1011011001111,
1000001111011,
1110100011001,
1111101100010,
1000001110101,
1110011000000,
1100101110111,
1101000100100,
1010110011011,
1001001101011,
1000100011010,
1011011000010,
1001111100000,
1101111000101,
1001101111010,
1010000101101,
1011100011011,
1011001011010,
1010010101101,
1100101101011,
1100111011101,
1111011001111,
1001010101011,
1111101011110,
1010100000111,
1001101011001,
1001101000101,
1101111000001,
1010100010000,
1011011111100,
1110101101011,
1000000011001,
1000000101101,
1101100010010,
1101110011101,
1001110010011,
1001011000111,
1111101001110,
1010101101010,
1001100010000,
1100101010101,
1111101110111,
1001101010001,
1111001100101,
1001101101101,
1111100101000,
1100001100011,
1011000011010,
1101111000111,
1101000010100,
1000011001001,
1111010101101,
1100110010100,
1011001111000,
1001001100110,
1010100110000,
1101100001010,
1111100100001,
1000110010000,
1100100000100,
1011100101000,
1100111101011,
1001111100001,
1111001011001,
1000000010101,
1011000010011,
1100111000010,
1000100001101,
1110100010110,
1001110001111,
1001101110010,
1110110101000,
1100111011010,
1011001110111,
1011111011111,
1101111111100,
1001100100110,
1101101111111,
1010000111101,
1010000000111,
1010110000100,
1111101001000,
1011101101110,
1010011011111,
1000000101100,
1101011100000,
1010111111010,
1111001011000,
1001000100110,
1110000001010,
1110101011011,
1101001010000,
1000000110110,
1000100101100,
1001000010010,
1101010010000,
1011100010001,
1001100101010,
1010110001010,
1011000100110,
1110001111010,
1100001011100,
1010001111010,
1111101010100,
1100001111010,
1000100011000,
1011110111100,
1111110010000,
1000011111100,
1001010101100,
1011100001101,
1101100001101,
1111010000111,
1001110100011,
1100001001110,
1110011001010,
1000101111110,
1111101010010,
1101000001110,
1001100111101,
1111110101010,
1001101001010,
1000011110011,
1000001010110,
1110111010110,
1110011111001,
1110111001110,
1011100111001,
1111101100011,
1010110001000,
1100100100101,
1111001110001,
1001101101011,
1111000101110,
1011000100010,
1001100001010,
1101001011101,
1101001000110,
1101001110100,
1100010010011,
1111011110011,
1011100111101,
1100110010000,
1111110001010,
1101011111010,
1101110101100,
1100010100000,
1110101001011,
1111001101111,
1101010110000,
1110011010110,
1101001110101,
1001011011100,
1111100011110,
1011000111110,
1011100111100,
1001101000011,
1101110010111,
1110011101110,
1001100011100,
1001100001000,
1010000010011,
1110011111000,
1101010001001,
1001001110110,
1111000000010,
1101110100110,
1010000000011,
1100100001000,
1000000101010,
1110000111010,
1000101110111,
1110101100011,
1010111101011,
1010110100100,
1011010100111,
1010110111100,
1011010011100,
1001110110100,
1010110100000,
1010010111100,
1001001100001,
1101010000001,
1100010101011,
1010011100010,
1110010001001,
1111110110101,
1111001100110,
1101010011101,
1000100110100,
1011000111100,
1000001011010,
1100100001010,
1110010001100,
1101111001101,
1011101101001,
1001011111101,
1101001011111,
1111011001110,
1001000010000,
1000000000011,
1011100100000,
1000101001010,
1100101100100,
1101000100101,
1101011111000,
1100101111010,
1100011110110,
1011110010011,
1101111110101,
1000000110000,
1111101011010,
1110001110001,
1100000001110,
1101101000000,
1110110010100,
1100011000111,
1011000000100,
1011010110110,
1100100001100,
1011000110001,
1000011010001,
1011010111111,
1011110001110,
1111111000000,
1000111011001,
1110100000100,
1110101000111,
1011001101010,
1010000100010,
1110010000100,
1011011001010,
1010100011000,
1111000100001,
1011001110010,
1011111010111,
1001000110001,
1110010011101,
1001110010001,
1001011011000,
1000111010000,
1010010011010,
1011110110110,
1010010000010,
1000000111000,
1101110101010,
1110111010001,
1010010000100,
1001110010100,
1101011110011,
1001000100100,
1110000110000,
1100011000101,
1000011100010,
1010101111100,
1110110110100,
1111110000100,
1011010110100,
1001111001111,
1101010111011,
1010010000001,
1001011101101,
1001001000011,
1000111100100,
1100111111000,
1011111001011,
1011110101001,
1101011101101,
1101110111011,
1111111101000,
1110000100011,
1011101010011,
1111100000111,
1011110101000,
1001000110101,
1110101111011,
1010101000001,
1110111011011,
1000100000101,
1011010010101,
1000111010010,
1100011001101,
1001011011011,
1001001111111,
1100100110010,
1101100101000,
1110111010011,
1111000011001,
1100000001111,
1001001111001,
1001010010000,
1011010011111,
1111100010001,
1010101001010,
1000100001011,
1011110000100,
1101101110101,
1011100001010,
1100110110110,
1001110111100,
1010010101010,
1000101011111,
1101101010111,
1100110100000,
1100110100001,
1010110010010,
1011010100010,
1101001110110,
1011110000111,
1001001010010,
1010011001101,
1011000011000,
1101001100011,
1011111100100,
1110111110111,
1010010110001,
1100111000111,
1100001100000,
1100101001001,
1001010110011,
1101111110010,
1111100101100,
1100011101111,
1010010111101,
1010001010101,
1100011001011,
1101111100010,
1101011010011,
1101111001000,
1111111111111,
1101001111101,
1011111110010,
1101111010010,
1011000000010,
1101110101101,
1011011100101,
1111110011111,
1110101110101,
1000001011110,
1110110110111,
1001001001000,
1000100111011,
1011101011111,
1101110000111,
1100011100100,
1011000110011,
1110100011111,
1101010001011,
1000000010011,
1110101010011,
1001101010000,
1011011010101,
1000101100110,
1100110001111,
1100011010101,
1111100101001,
1101111010001,
1000011001000,
1100110000111,
1101001111010,
1000110000110,
1010100101011,
1101011111100,
1000111000010,
1111000100111,
1110010101100,
1111000000100,
1101101000001,
1110101001110,
1001100100100,
1011000011111,
1000010111100,
1100010101010,
1000001011111,
1011001100001,
1010010000111,
1111100111010,
1110100011100,
1101000101111,
1010110001001,
1101111100110,
1101101110110,
1001010101000,
1000101110110,
1101101111001,
1110000001001,
1110101100000,
1011100110110,
1101110010101,
1111001101100,
1101000011011,
1011001010110,
1101111011110,
1001110101111,
1000100110110,
1101110100111,
1001010010100,
1001000000000,
1100100001110,
1101011000010,
1001011111011,
1011111100111,
1100001001100,
1000001101100,
1110001101101,
1010101001001,
1000000011110,
1010100111001,
1011111100010,
1011000010100,
1000001111101,
1011110011101,
1010001010111,
1001100110001,
1101111001010,
1100100010000,
1101011101011,
1011110001001,
1001101100011,
1010010100100,
1111010101010,
1011010100011,
1010100011010,
1001000000110,
1100011001100,
1011111000010,
1111011011101,
1111101010111,
1000101011110,
1101011101001,
1100111110001,
1000000011101,
1100010001010,
1000000010000,
1111001100100,
1101100111000,
1100011000010,
1010011010111,
1011110111101,
1111000110101,
1001000001001,
1111001100111,
1010001001010,
1011101110101,
1001111111111,
1000101001100,
1010011010000,
1000111111101,
1100101110100,
1110011110110,
1100110111101,
1011011101001,
1001111101111,
1110010001110,
1110100111101,
1001111101110,
1100110100100,
1010011001111,
1110001011000,
1100101110010,
1101101101100,
1001010111111,
1111000000111,
1110100101011,
1100100000000,
1100100111101,
1110110000000,
1110010010100,
1111100110000,
1101110001100,
1110001111100,
1111001100000,
1111011100011,
1100100011101,
1000111110111,
1011011000100,
1111001101000,
1000001011011,
1100000101101,
1100011010100,
1010111000000,
1011111001101,
1010000101011,
1110001010110,
1001101100111,
1111101111011,
1000100101001,
1000000100110,
1011011111110,
1001011010001,
1101110010010,
1010101101101,
1100111011011,
1100001111000,
1011110011011,
1001001110011,
1010100011011,
1001001110010,
1111101010101,
1010111011001,
1000001001110,
1010111010110,
1000000100000,
1000001101101,
1001110101000,
1100100101001,
1111100001010,
1110110101010,
1000101111000,
1011010100000,
1100111101111,
1110000110110,
1001001000111,
1100110101011,
1010011100000,
1010110011101,
1111110100111,
1110000000001,
1011101001101,
1101110100100,
1011110011010,
1000111001110,
1110100001100,
1110011011000,
1000001010010,
1011111010010,
1011111010101,
1000101110011,
1111001011111,
1001111110101,
1110111000011,
1001011101100,
1110010000000,
1100001011010,
1001111110111,
1111110011110,
1110111100001,
1001010000001,
1110111101110,
1001100000110,
1000110001001,
1110001101110,
1111110101001,
1111101101111,
1010110110100,
1100101011010,
1011111110110,
1001110111001,
1011000101110,
1010001010001,
1101000000000,
1001010000110,
1011110111001,
1010000001011,
1101110110101,
1100011011001,
1000100111000,
1011000111111,
1010010100010,
1101100110110,
1011001010101,
1111000001101,
1111101011101,
1111011010101,
1101100101110,
1100101010001,
1001011000001,
1101110111010,
1100010110100,
1010011001100,
1100001100110,
1000101010111,
1001110110010,
1100100010101,
1000100100000,
1100101101101,
1010101000011,
1000100011101,
1101000001100,
1111111101111,
1110000111011,
1001011100010,
1100100101100,
1011011100110,
1101010110101,
1000111110100,
1101111100100,
1001001111101,
1010000111000,
1000000101000,
1001000010111,
1001011010000,
1110010111011,
1100111101101,
1011100111011,
1101100101001,
1010010000011,
1100110001110,
1101000011100,
1010111001000,
1011111111001,
1010100111111,
1011000110111,
1000001100101,
1100101100010,
1001111110000,
1100000011011
};

long diag_report_tmp[]={
100100,
111110,
110110,
110111,
110101,
101111,
100111,
111100,
110000,
111001,
100010,
101010
};

int main(){
	int i, j, bitcount[len] = {0}, pos=0;
	long gamma=0, epsilon=0;
/*
	for(i=0; i<sizeof(diag_report)/sizeof(long); i++){
		for(j=1; j<len; j++)
		{
			pos = (len-j-1);
			if((diag_report[i]/int_pow(10, pos)) & 0x1){
				bitcount[j] += 1;
			}
			else{
				bitcount[j] -= 1;
			}
		}
	}

	for(j=0; j<len; j++)
	{
		if(bitcount[j] > 0)
		{
			gamma += int_pow(2, (len-j-1));
		}else if(j>0){
			epsilon += int_pow(2, (len-j-1));
		}
	}
	
	printf("gamma = %lu epsilon = %lu\n", gamma, epsilon);
	printf("power comsumptiom = %lu", gamma*epsilon);
*/
	/* part 2 */
	int remove_zero;
	long *list_tmp;
	long *oxy_list, *co2_list, oxy=0, co2=0;
	int list_number=sizeof(diag_report)/sizeof(long);

	oxy_list = malloc(sizeof(diag_report));
	co2_list = malloc(sizeof(diag_report));
	memcpy(oxy_list, diag_report, sizeof(diag_report));
	memcpy(co2_list, diag_report, sizeof(diag_report));

	for(j=1; j<len; j++){
		pos = (len-j-1);
		for(i=0;i<sizeof(diag_report)/sizeof(long);i++){
			if(oxy_list[i] != -1){		
	//			printf("%d, %d\n",diag_report[i]/int_pow(10,pos), pos);
				if((oxy_list[i]/int_pow(10, pos)) & 0x1){
					bitcount[j] += 1;
				}
				else{
					bitcount[j] -= 1;
				}
			}
		}
		
		if(bitcount[j]>=0){
			remove_zero=1;
			oxy += int_pow(2, pos);
		}else{
			remove_zero=0;
		}

		for(i=0;i<sizeof(diag_report)/sizeof(long);i++){
			if(oxy_list[i] == -1)
				continue;
			if((remove_zero && !((oxy_list[i]/int_pow(10, pos)) & 0x1))
				|| (!remove_zero && ((oxy_list[i]/int_pow(10, pos)) & 0x1))){	
				if(list_number == 0){
					printf("\nlast ont(oxy) == %lu\n", oxy_list[i]);
					oxy = oxy_list[i];
					j = len;
					break;
				}
				oxy_list[i] = -1;					
			}	
		}		
		
		printf(" %d", remove_zero);
	}

	printf("\noxy = %lu\n", oxy);
/* co2  */
	memset(bitcount, 0,sizeof(bitcount));
	for(j=1; j<len; j++){
		pos = (len-j-1);
		for(i=0;i<sizeof(diag_report)/sizeof(long);i++){
			if(co2_list[i] != -1){		
	//			printf("%d, %d\n",diag_report[i]/int_pow(10,pos), pos);
				if((co2_list[i]/int_pow(10, pos)) & 0x1){
					bitcount[j] += 1;
				}
				else{
					bitcount[j] -= 1;
				}
			}
		}
		
		if(bitcount[j]>=0){
			remove_zero=0;
		}else{
			remove_zero=1;

		co2 += int_pow(2, pos);
		}
//		printf("co2_tmp = %lu\n",co2);

//		printf(" %d", remove_zero);
//		printf("list :\n");
		for(i=0;i<sizeof(diag_report)/sizeof(long);i++){
			if(co2_list[i] == -1)
				continue;
			if((remove_zero && !((co2_list[i]/int_pow(10, pos)) & 0x1))
				|| (!remove_zero && ((co2_list[i]/int_pow(10, pos)) & 0x1))){	
				list_number--;
//				printf("\nlist number = %d\n", list_number);
				if(list_number == 0){
					printf("\nlast ont(co2) == %lu\n", co2_list[i]);
					co2 = co2_list[i];
					j = len;
					break;
				}
				co2_list[i] = -1;
			}else{	
//				printf("%lu\n", co2_list[i]);
			}
		}
	}
	printf("co2 = %lu", co2);

	free(oxy_list);
	free(co2_list);
	return 0;
}
